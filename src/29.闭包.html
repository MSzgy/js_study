<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>29.闭包</title>
</head>
<body>
  <button>b1</button>
  <button>b2</button>
  <button>b3</button>
  <script type="text/javascript">
    // var btns = document.getElementsByTagName('button');
    //
    // //利用闭包
    // for (var i = 0, Length=btns.length; i < Length; i++) {
    //   (function (i) {
    //     var btn = btns[i];
    //     btn.onclick = function () {
    //       alert(i);
    //     }
    //   })(i);
    // }

    /**
     * 闭包是什么
     *      闭包是嵌套的内部函数
     *      包含被引用变量（函数）的对象
     *      闭包存在于嵌套的内部函数中
     * 产生闭包的条件
     *      函数嵌套
     *      内部函数引用了外部函数的数据（变量/函数）
     *      执行外部函数
     * 作用
     *      1 使用函数内部的变量在函数执行完后，仍然存活在内存中（延长了局部变量的生命周期）
     *      2 让函数外部可以操作（读写）到函数内部的数据（变量/函数）
     * 缺点
     *      函数执行完后，函数内的局部变量没有释放，占用内存时间会变长
     *      容易造成内存泄漏
     *
     */
    function fn1 () {
        var a = 2;
        function fn2 () {
            console.log(a);
        }
    }
    fn1();

    /**
     * 常见的闭包
     */
    // 将函数作为另一个函数的返回值
    function fn2() {
        var a = 3;
        function fn3() {
            a++;
            console.log(a);
        }
        return fn3;
    }
    var f = fn2();
    f();
    f();

    // 将函数作为实参传递给另一个函数调用
    function showDelay(msg, time) {
        setTimeout(function () {
            alert(msg)
        }, time)
    }
    showDelay("zgy", 2000)


  </script>
</body>
</html>